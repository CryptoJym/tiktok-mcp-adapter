openapi: 3.0.0
info:
  title: TikTok MCP Adapter API
  version: v1.0.0
  description: API for the TikTok MCP Adapter, facilitating video uploads and publishing to TikTok.
servers:
  - url: http://localhost:3002 # Example URL, will be replaced by actual deployment URL
    description: Local development server

components:
  schemas:
    TikTokPostRequest:
      type: object
      properties:
        video_url:
          type: string
          format: url
          description: The publicly accessible URL of the video to be uploaded to TikTok (HeyGen MP4 URL).
          example: "https://heygen-videos.com/video_abc123.mp4"
        title:
          type: string
          description: The title for the TikTok post. This will be used to form the caption.
          example: "Check out this amazing new clip generated by AutoClipper!"
        hashtags:
          type: array
          items:
            type: string
          description: A list of hashtags to include with the post.
          example: ["#autoclipper", "#ai", "#videogeneration"]
        privacy_level:
          type: string
          enum: [PUBLIC_TO_EVERYONE, SELF_ONLY, DRAFT] # Corresponds to TikTok's options; PRD mentions 'public' and 'draft'
          description: The privacy setting for the TikTok post.
          default: PUBLIC_TO_EVERYONE # Default can be overridden by system config
      required:
        - video_url
        - title

    TikTokPostResponse:
      type: object
      properties:
        tiktok_post_id:
          type: string
          description: The unique identifier for the TikTok post.
          example: "tiktok_post_789xyz123"
        share_url:
          type: string
          format: url
          description: The shareable URL for the TikTok post.
          example: "https://www.tiktok.com/@your_username/video/789xyz123"
        status_message:
          type: string
          description: A message indicating the status of the publishing request (e.g., "Post initiated successfully").
          example: "Post creation initiated. Check status endpoint for updates."

    TikTokStatusResponse:
      type: object
      properties:
        tiktok_post_id:
          type: string
          description: The unique identifier for the TikTok post.
        current_status:
          type: string
          description: Current status of the post (e.g., PROCESSING, PUBLISHED, FAILED_TO_PUBLISH, PENDING_REVIEW, DELETED).
          example: "PUBLISHED"
        share_url:
          type: string
          format: url
          description: The shareable URL for the TikTok post (if available).
          nullable: true
        failure_reason:
          type: string
          description: Reason for failure, if the post status is FAILED_TO_PUBLISH.
          nullable: true
          example: "Video content violates community guidelines."

paths:
  /publish:
    post:
      summary: Publish a video to TikTok
      description: Takes a video URL (e.g., from HeyGen) and metadata, then attempts to publish it to TikTok using the PULL_FROM_URL method. The adapter handles forming the caption from title and hashtags.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TikTokPostRequest'
      responses:
        '202': # Accepted for processing
          description: TikTok post request accepted and is being processed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TikTokPostResponse'
        '400':
          description: Bad Request - Invalid input parameters (e.g., malformed URL, missing required fields).
        '500':
          description: Internal Server Error - The adapter failed to initiate the TikTok post.

  /publish/{post_id}/status:
    get:
      summary: Get TikTok post status
      description: Retrieves the current publishing status of a TikTok post using its ID.
      parameters:
        - name: post_id
          in: path
          required: true
          description: The unique identifier of the TikTok post (returned from the /publish endpoint).
          schema:
            type: string
            example: "tiktok_post_789xyz123"
      responses:
        '200':
          description: Successfully retrieved post status.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TikTokStatusResponse'
        '404':
          description: Not Found - The specified Post ID was not found or doesn't belong to this integration.
        '500':
          description: Internal Server Error - The adapter failed to retrieve the status.